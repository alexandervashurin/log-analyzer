<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Log Analyzer</title>
    <style>
        body { font-family: sans-serif; max-width: 1000px; margin: 20px auto; }
        .box { border: 1px solid #ccc; padding: 15px; margin-bottom: 15px; border-radius: 5px; }
        textarea { width: 100%; height: 200px; font-family: monospace; }
        button { padding: 10px 20px; background: #007bff; color: white; border: none; cursor: pointer; }
        button:hover { background: #0056b3; }
        .stat { display: inline-block; margin-right: 15px; font-weight: bold; }
        .err { color: #dc3545; } .warn { color: #ffc107; } .info { color: #17a2b8; }
        pre { background: #f8f9fa; padding: 10px; overflow: auto; }
    </style>
</head>
<body>
    <h1>üîç –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –ª–æ–≥–æ–≤</h1>
    <div class="box">
        <h3>üìù –¢–µ–∫—Å—Ç</h3>
        <textarea id="logText" placeholder="–í—Å—Ç–∞–≤—å—Ç–µ –ª–æ–≥–∏..."></textarea><br><br>
        <button onclick="analyzeText()">–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å</button>
    </div>
    <div class="box">
        <h3>üìÅ –§–∞–π–ª</h3>
        <input type="file" id="logFile"><br><br>
        <button onclick="analyzeFile()">–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª</button>
    </div>
    <div class="box" id="results" style="display:none;"></div>
    <script>
        async function analyzeText() {
            const text = document.getElementById('logText').value;
            const res = await fetch('/api/analyze/text', { method: 'POST', body: text });
            showResults(await res.json());
        }
        async function analyzeFile() {
            const file = document.getElementById('logFile').files[0];
            if (!file) return alert('–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª');
            const res = await fetch('/api/analyze/file', { method: 'POST', body: file });
            showResults(await res.json());
        }
        function showResults(stats) {
            const div = document.getElementById('results');
            div.style.display = 'block';
            div.innerHTML = `
                <div>
                    <span class="stat">–í—Å–µ–≥–æ: ${stats.totalLines}</span>
                    <span class="stat err">–û—à–∏–±–∫–∏: ${stats.errorCount}</span>
                    <span class="stat warn">–í–∞—Ä–Ω–∏–Ω–≥–∏: ${stats.warningCount}</span>
                    <span class="stat info">–ò–Ω—Ñ–æ: ${stats.infoCount}</span>
                </div>
                ${stats.timeRange ? `<p>–í—Ä–µ–º—è: ${stats.timeRange[0]} - ${stats.timeRange[1]}</p>` : ''}
                ${Object.keys(stats.topErrors).length ? `<h4>–¢–æ–ø –æ—à–∏–±–æ–∫:</h4><pre>${JSON.stringify(stats.topErrors, null, 2)}</pre>` : ''}
            `;
        }
    </script>
</body>
</html>